jQuery(function(a){function b(b,c,d){let e=d.find("fieldset > .notice");switch(e.hide(),e.removeClass("notice-error"),e.removeClass("notice-success"),b){case"export_settings":if(c.success&&c.data.filename&&c.data.settings){d.find(".download_file").remove();let b={type:d.find("select[name=\"type\"").val(),settings:c.data.settings};b="data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify(b)),d.append(a("<div class=\"download_file\"><label>"+wpo_wcpdf_debug.download_label+":</label> <a href=\"data:"+b+"\" download=\""+c.data.filename+"\">"+c.data.filename+"</a></div>"))}else!c.success&&c.data.message&&(e.addClass("notice-error"),e.find("p").text(c.data.message),e.show());break;default:c.success&&c.data.message?(e.addClass("notice-success"),d.find("> .notice-warning").remove()):!c.success&&c.data.message&&e.addClass("notice-error"),e.find("p").text(c.data.message),e.show()}}function c(b,d,e,f,g,h,i){let j={action:"wpo_wcpdf_danger_zone_tools",delete_or_renumber:i,document_type:b,date_type:d,date_from:e,date_to:f,page_count:g,document_count:h,nonce:wpo_wcpdf_debug.nonce};a.ajax({type:"POST",url:wpo_wcpdf_debug.ajaxurl,data:j,dataType:"json",success:function(j){if(!1===j.data.finished)g=j.data.pageCount,h=j.data.documentCount,c(b,d,e,f,g,h,i);else{a(".renumber-spinner, .delete-spinner").css("visibility","hidden"),a("#renumber-documents-btn, #delete-documents-btn").removeAttr("disabled"),a("#renumber-document-type, #renumber-date-from, #renumber-date-to, #delete-document-type, #delete-date-from, #delete-date-to").prop("disabled",!1);let b=j.data.message;alert(h+b)}},error:function(a,b,c){alert(a.status+":"+c)}})}if(a("#debug-tools .tool").on("click","input[type=\"submit\"]",function(c){c.preventDefault();let d=a(this).closest("form"),e=d.find("input[name=\"debug_tool\"]").val(),f=new FormData(d[0]);f.append("action","wpo_wcpdf_debug_tools"),f.append("nonce",wpo_wcpdf_debug.nonce),d.closest(".tool").block({message:null,overlayCSS:{background:"#fff",opacity:.6}});let g=!1;g="reset-settings"!==e||window.confirm(wpo_wcpdf_debug.confirm_reset),g&&a.ajax({url:wpo_wcpdf_debug.ajaxurl,data:f,type:"POST",cache:!1,processData:!1,contentType:!1,success(a){b(e,a,d),d.closest(".tool").unblock()},error(){d.closest(".tool").unblock()}})}),a("[name='wpo_wcpdf_settings_debug[document_access_denied_redirect_page]']").on("change",function(){let b=a(this).closest("table").find("#document_custom_redirect_page"),c=b.closest("td").find(".description");"custom_page"===a(this).val()?(b.show(),c.show()):(b.hide(),c.hide())}).trigger("change"),!0===wpo_wcpdf_debug.danger_zone.enabled){let b="<div class=\"notice notice-warning inline\"><p>"+wpo_wcpdf_debug.danger_zone.message+"</p></div>";a("input#enable_danger_zone_tools").closest("td").find(".description").append(b)}a(document.body).on("click","#wpo-wcpdf-settings a.number-search-button",function(b){b.preventDefault();let c=a(this).closest("div").find(":input[name=\"number_search_input\"]").val();window.location.href=window.location.href+"&s="+c}),a("#renumber-date-from, #renumber-date-to, #delete-date-from, #delete-date-to").datepicker({dateFormat:"yy-mm-dd"}),a(document.body).on("click","#debug-tools .number-tools-btn",function(b){b.preventDefault();let d="",e="",f="",g="";return"renumber-documents-btn"===this.id?(d=a("#renumber-document-type").val(),dateType=a("#renumber-date-type").val(),e=a("#renumber-date-from").val(),f=a("#renumber-date-to").val(),g="renumber"):"delete-documents-btn"===this.id&&(d=a("#delete-document-type").val(),dateType=a("#delete-date-type").val(),e=a("#delete-date-from").val(),f=a("#delete-date-to").val(),g="delete"),""===d||"undefined"===d?void alert(wpo_wcpdf_debug.select_document_type):void("renumber"===g?a(".renumber-spinner").css("visibility","visible"):"delete"===g&&a(".delete-spinner").css("visibility","visible"),a("#renumber-documents-btn, #delete-documents-btn").attr("disabled",!0),a("#renumber-document-type, #renumber-date-from, #renumber-date-to, #delete-document-type, #delete-date-from, #delete-date-to").prop("disabled",!0),c(d,dateType,e,f,1,0,g))}),a("#debug-tools #delete-document-type").on("change",function(b){b.preventDefault(),"all"===a(this).val()?a(this).closest("form").find("#delete-date-type option[value=\"document_date\"]").prop("disabled",!0):a(this).closest("form").find("#delete-date-type option[value=\"document_date\"]").prop("disabled",!1)}).trigger("change"),a("#debug-tools #delete-date-type").on("change",function(b){b.preventDefault();let c=a(this).closest("form").find("#delete-document-type");""===c.val()||"all"===c.val()?a(this).find("option[value=\"document_date\"]").prop("disabled",!0):a(this).find("option[value=\"document_date\"]").prop("disabled",!1)}).trigger("change")});